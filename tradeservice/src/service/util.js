const DBService = require('./DBService');
const Trade = require('../schema/Trade')

const data = [
    {"TradeId":1234,
	"TradeDate":'12/23/2017',
	"Commodity":'ZN',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Lorem',
	"Location":'NY'
	},
	{"TradeId":12341,
	"TradeDate":'12/21/2017',
	"Commodity":'ZN',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Lorem',
	"Location":'NY'
	},
	{"TradeId":12342,
	"TradeDate":'12/27/2017',
	"Commodity":'ZN',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Lorem',
	"Location":'NY'
	},
	{"TradeId":12343,
	"TradeDate":'12/12/2017',
	"Commodity":'ZN',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Lorem',
	"Location":'NY'
	},
	{"TradeId":12344,
	"TradeDate":'12/03/2017',
	"Commodity":'ZN',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Lorem',
	"Location":'NY'
	},
	{"TradeId":12345,
	"TradeDate":'12/14/2017',
	"Commodity":'ZN',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Lorem',
	"Location":'NY'
	},
	{"TradeId":12346,
	"TradeDate":'12/30/2017',
	"Commodity":'ZN',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Amet',
	"Location":'NY'
	},
	{"TradeId":12347,
	"TradeDate":'06/16/2017',
	"Commodity":'ZN',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Amet',
	"Location":'NY'
	},
	{"TradeId":12348,
	"TradeDate":'07/25/2017',
	"Commodity":'AG',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Amet',
	"Location":'NY'
	},
	{"TradeId":12349,
	"TradeDate":'12/15/2017',
	"Commodity":'AG',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Amet',
	"Location":'NY'
	},
	{"TradeId":123410,
	"TradeDate":'12/09/2017',
	"Commodity":'AG',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Amet',
	"Location":'NY'
	},
	{"TradeId":123411,
	"TradeDate":'12/15/2017',
	"Commodity":'AG',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Amet',
	"Location":'NY'
	},
	{"TradeId":123412,
	"TradeDate":'12/17/2017',
	"Commodity":'AG',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Amet',
	"Location":'NY'
	},
	{"TradeId":123413,
	"TradeDate":'12/23/2017',
	"Commodity":'AU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Amet',
	"Location":'NY'
	},
	{"TradeId":123414,
	"TradeDate":'12/13/2017',
	"Commodity":'AU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Dolor',
	"Location":'NY'
	},
	{"TradeId":123415,
	"TradeDate":'12/03/2017',
	"Commodity":'AU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Dolor',
	"Location":'NY'
	},
	{"TradeId":123416,
	"TradeDate":'12/09/2017',
	"Commodity":'AU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Dolor',
	"Location":'NY'
	},
	{"TradeId":123417,
	"TradeDate":'12/27/2017',
	"Commodity":'AU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Dolor',
	"Location":'NY'
	},
	{"TradeId":123418,
	"TradeDate":'12/11/2017',
	"Commodity":'AU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Dolor',
	"Location":'NY'
	},
	{"TradeId":123419,
	"TradeDate":'12/15/2017',
	"Commodity":'AU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Dolor',
	"Location":'NY'
	},
	{"TradeId":123420,
	"TradeDate":'12/13/2017',
	"Commodity":'AU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Dolor',
	"Location":'NY'
	},
	{"TradeId":123421,
	"TradeDate":'12/03/2017',
	"Commodity":'AU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Dolor',
	"Location":'NY'
	},
	{"TradeId":123422,
	"TradeDate":'12/11/2017',
	"Commodity":'AU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Ipsum',
	"Location":'NY'
	},
	{"TradeId":123423,
	"TradeDate":'12/12/2017',
	"Commodity":'AL',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Ipsum',
	"Location":'NY'
	},
	{"TradeId":123424,
	"TradeDate":'12/10/2017',
	"Commodity":'CU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Ipsum',
	"Location":'NY'
	},
	{"TradeId":123425,
	"TradeDate":'12/15/2017',
	"Commodity":'CU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Ipsum',
	"Location":'NY'
	},
	{"TradeId":123426,
	"TradeDate":'12/20/2017',
	"Commodity":'CU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Ipsum',
	"Location":'NY'
	},
	{"TradeId":123427,
	"TradeDate":'12/11/2017',
	"Commodity":'CU',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Ipsum',
	"Location":'NY'
	},
	{"TradeId":123428,
	"TradeDate":'12/16/2017',
	"Commodity":'AL',
	"Side":'Buy',
	"Qty":100,
	"Price":2000,
	"CounterParty":'Ipsum',
	"Location":'NY'
	}	
]

function createTrades() {
    DBService.connect()
    data.forEach(d => {
        console.log(new Date(d.TradeDate))
        new Trade({TradeId: d.TradeId,TradeDate: new Date(d.TradeDate), Commodity: d.Commodity, Side: d.Side, 
    Qty: d.Qty, Price: d.Price, Counterparty: d.CounterParty, Location: d.Location}).save()
    })

}

//createTrades()

function upsertDemo() {
	//DBService.connect()
	let trade = new Trade({
		TradeId: 2135,TradeDate: new Date(01-01-1988), Commodity: 'AG', Side: 'Buy', 
    Qty: 7, Price: 7000, Counterparty: 'Amet', Location: 'NY'
	})
	DBService.upsertTrade(trade)
}

//upsertDemo()

